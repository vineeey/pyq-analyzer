{% extends 'base/base.html' %}

{% block title %}Dashboard - PYQ Analyzer{% endblock %}

{% block extra_head %}
<style>
    .stat-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .stat-card:hover {
        transform: translateY(-8px) scale(1.02);
    }
    
    .counter {
        font-variant-numeric: tabular-nums;
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- Welcome Header -->
    <div class="mb-12 fade-in">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between">
            <div>
                <h1 class="text-4xl md:text-5xl font-black bg-gradient-to-r from-indigo-600 to-purple-600 dark:from-indigo-400 dark:to-purple-400 bg-clip-text text-transparent mb-3">
                    Welcome back!
                </h1>
                <p class="text-xl text-gray-600 dark:text-gray-400">
                    Hi <span class="font-semibold text-indigo-600 dark:text-indigo-400">{{ user.get_display_name }}</span>, ready to ace your exams?
                </p>
            </div>
            <div class="mt-4 md:mt-0">
                <a href="{% url 'papers:generic_upload' %}" 
                   class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-2xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
                    <i data-lucide="upload" class="w-5 h-5 mr-2"></i>
                    Upload Papers
                </a>
            </div>
        </div>
    </div>
    
    <!-- Stats Cards with Animation -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
        <!-- Stat Card 1 -->
        <div class="stat-card glass dark:glass rounded-3xl p-8 border border-white/20 dark:border-white/10 shadow-xl hover:shadow-2xl fade-in" style="animation-delay: 0.1s;">
            <div class="flex items-center justify-between mb-4">
                <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl flex items-center justify-center transform -rotate-3 group-hover:rotate-0 transition-transform duration-300">
                    <i data-lucide="book" class="w-8 h-8 text-white"></i>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide">Total Subjects</p>
                    <p class="text-4xl font-black text-gray-900 dark:text-white counter" data-target="{{ total_subjects }}">0</p>
                </div>
            </div>
            <div class="h-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full"></div>
        </div>
        
        <!-- Stat Card 2 -->
        <div class="stat-card glass dark:glass rounded-3xl p-8 border border-white/20 dark:border-white/10 shadow-xl hover:shadow-2xl fade-in" style="animation-delay: 0.2s;">
            <div class="flex items-center justify-between mb-4">
                <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-teal-600 rounded-2xl flex items-center justify-center transform -rotate-3 group-hover:rotate-0 transition-transform duration-300">
                    <i data-lucide="file-text" class="w-8 h-8 text-white"></i>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide">Papers Uploaded</p>
                    <p class="text-4xl font-black text-gray-900 dark:text-white counter" data-target="{{ total_papers }}">0</p>
                </div>
            </div>
            <div class="h-2 bg-gradient-to-r from-green-500 to-teal-600 rounded-full"></div>
        </div>
        
        <!-- Stat Card 3 -->
        <div class="stat-card glass dark:glass rounded-3xl p-8 border border-white/20 dark:border-white/10 shadow-xl hover:shadow-2xl fade-in" style="animation-delay: 0.3s;">
            <div class="flex items-center justify-between mb-4">
                <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center transform -rotate-3 group-hover:rotate-0 transition-transform duration-300">
                    <i data-lucide="help-circle" class="w-8 h-8 text-white"></i>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide">Questions Analyzed</p>
                    <p class="text-4xl font-black text-gray-900 dark:text-white counter" data-target="{{ total_questions }}">0</p>
                </div>
            </div>
            <div class="h-2 bg-gradient-to-r from-purple-500 to-pink-600 rounded-full"></div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="glass dark:glass rounded-3xl p-8 shadow-xl border border-white/20 dark:border-white/10 fade-in" style="animation-delay: 0.4s;">
        <div class="flex items-center mb-6">
            <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center mr-4">
                <i data-lucide="zap" class="w-6 h-6 text-white"></i>
            </div>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Quick Actions</h2>
        </div>
        
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
            <a href="{% url 'papers:generic_upload' %}" 
               class="group flex items-center p-5 bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-2xl hover:from-indigo-100 hover:to-purple-100 dark:hover:from-indigo-900/30 dark:hover:to-purple-900/30 transition-all duration-300 border border-indigo-200/50 dark:border-indigo-700/50">
                <div class="w-12 h-12 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center mr-4 group-hover:scale-110 transition-transform duration-300">
                    <i data-lucide="upload" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Upload</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Add Papers</div>
                </div>
            </a>
            
            <a href="{% url 'subjects:list' %}" 
               class="group flex items-center p-5 bg-gradient-to-br from-green-50 to-teal-50 dark:from-green-900/20 dark:to-teal-900/20 rounded-2xl hover:from-green-100 hover:to-teal-100 dark:hover:from-green-900/30 dark:hover:to-teal-900/30 transition-all duration-300 border border-green-200/50 dark:border-green-700/50">
                <div class="w-12 h-12 bg-gradient-to-br from-green-600 to-teal-600 rounded-xl flex items-center justify-center mr-4 group-hover:scale-110 transition-transform duration-300">
                    <i data-lucide="list" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Subjects</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">View All</div>
                </div>
            </a>
            
            <a href="{% url 'questions:list' %}" 
               class="group flex items-center p-5 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-2xl hover:from-purple-100 hover:to-pink-100 dark:hover:from-purple-900/30 dark:hover:to-pink-900/30 transition-all duration-300 border border-purple-200/50 dark:border-purple-700/50">
                <div class="w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center mr-4 group-hover:scale-110 transition-transform duration-300">
                    <i data-lucide="search" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Questions</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Browse</div>
                </div>
            </a>
            
            <a href="{% url 'users:profile' %}" 
               class="group flex items-center p-5 bg-gradient-to-br from-gray-50 to-slate-50 dark:from-gray-800/50 dark:to-slate-800/50 rounded-2xl hover:from-gray-100 hover:to-slate-100 dark:hover:from-gray-800/70 dark:hover:to-slate-800/70 transition-all duration-300 border border-gray-200/50 dark:border-gray-700/50">
                <div class="w-12 h-12 bg-gradient-to-br from-gray-600 to-slate-600 rounded-xl flex items-center justify-center mr-4 group-hover:scale-110 transition-transform duration-300">
                    <i data-lucide="settings" class="w-6 h-6 text-white"></i>
                </div>
                <div>
                    <div class="text-sm font-medium text-gray-900 dark:text-white">Settings</div>
                    <div class="text-xs text-gray-600 dark:text-gray-400">Profile</div>
                </div>
            </a>
        </div>
    </div>
</div>

<script>
    // Animated counter for stats with time-based approach
    document.addEventListener('DOMContentLoaded', function() {
        const counters = document.querySelectorAll('.counter');
        
        counters.forEach(counter => {
            const target = parseInt(counter.getAttribute('data-target')) || 0;
            const duration = 2000; // 2 seconds
            
            const animateCounter = (startTime) => {
                const currentTime = Date.now();
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function for smooth animation
                const easeOutCubic = (t) => 1 - Math.pow(1 - t, 3);
                const current = Math.floor(target * easeOutCubic(progress));
                
                counter.textContent = current;
                
                if (progress < 1) {
                    requestAnimationFrame(() => animateCounter(startTime));
                } else {
                    counter.textContent = target;
                }
            };
            
            // Start animation when element is in view
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        animateCounter(Date.now());
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });
            
            observer.observe(counter);
        });
    });
</script>
{% endblock %}
